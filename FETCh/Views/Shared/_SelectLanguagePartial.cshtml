@using Microsoft.AspNetCore.Builder
@using Microsoft.AspNetCore.Localization
@using Microsoft.AspNetCore.Mvc.Localization
@using Microsoft.Extensions.Options

@inject IViewLocalizer Localizer
@inject IOptions<RequestLocalizationOptions> LocOptions

@{
    var requestCulture = Context.Features.Get<IRequestCultureFeature>();
    var cultureItems = LocOptions.Value.SupportedUICultures.ToList();
    var returnUrl = string.IsNullOrEmpty(Context.Request.Path) ? "~/" : $"~{Context.Request.Path.Value}{Context.Request.QueryString}";
    var currentCulture = requestCulture?.RequestCulture.UICulture.Name ?? "uk";
}

<li class="nav-item dropdown">
    <a class="nav-link text-dark dropdown-toggle remove-arrow" href="#" id="langDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" title="@Localizer["Choose language"]">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-globe2" viewBox="0 0 16 16">
            <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855-.143.268-.276.56-.395.872.705.157 1.472.257 2.282.287V1.077zM4.249 3.539c.142-.384.304-.744.481-1.078a6.7 6.7 0 0 1 .597-.933A7.01 7.01 0 0 0 3.051 3.05c.362.184.763.349 1.198.49zM3.509 7.5c.036-1.07.188-2.087.436-3.008a9.124 9.124 0 0 1-1.565-.667A6.964 6.964 0 0 0 1.018 7.5h2.49zm1.4-2.741a12.344 12.344 0 0 0-.4 2.741H7.5V5.091c-.91-.03-1.783-.145-2.591-.332zM8.5 5.09V7.5h2.99a12.342 12.342 0 0 0-.399-2.741c-.808.187-1.681.301-2.591.332zM4.51 8.5c.035.987.176 1.914.399 2.741A13.612 13.612 0 0 1 7.5 10.91V8.5H4.51zm3.99 0v2.409c.91.03 1.783.145 2.591.332.223-.827.364-1.754.4-2.741H8.5zm-3.282 3.696c.12.312.252.604.395.872.552 1.035 1.218 1.65 1.887 1.855V11.91c-.81.03-1.577.13-2.282.287zm.11 2.276a6.696 6.696 0 0 1-.598-.933 8.853 8.853 0 0 1-.481-1.079 8.38 8.38 0 0 0-1.198.49 7.01 7.01 0 0 0 3.276 1.522zm-1.383-2.964A13.36 13.36 0 0 1 3.508 8.5h-2.49a6.963 6.963 0 0 0 1.362 3.675c.47-.258.995-.482 1.565-.667zm6.728 2.964a7.009 7.009 0 0 0 3.276-1.522 8.38 8.38 0 0 0-1.198-.49 8.853 8.853 0 0 1-.481 1.079 6.696 6.696 0 0 1-.598.933zM10.855 12.03c.552.215 1.078.439 1.548.697.48-1.088.797-2.3.876-3.607H9.595a12.78 12.78 0 0 0 .385 2.415 12.507 12.507 0 0 0 .875.495zm2.816-8.522c-.47.258-.996.482-1.566.667.248.92.4 1.938.436 3.008h2.49a6.964 6.964 0 0 0-1.36-3.675z" />
        </svg>
    </a>
    <ul class="dropdown-menu dropdown-menu-end border-2 border-dark shadow" aria-labelledby="langDropdown">
        @foreach (var culture in cultureItems)
        {
            <li>
                <form id="selectLanguage_@culture.Name" asp-controller="Home" asp-action="SetLanguage" asp-route-returnUrl="@returnUrl" method="post" class="form-horizontal">
                    <input type="hidden" name="culture" value="@culture.Name" />
                    <button type="submit" class="dropdown-item @(culture.Name == currentCulture ? "active bg-dark" : "")">
                        @culture.NativeName
                    </button>
                </form>
            </li>
        }
    </ul>
</li>